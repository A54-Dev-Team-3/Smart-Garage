@model VisitViewModel

@if (Model.Vehicle == null || string.IsNullOrEmpty(Model.Vehicle.Brand))
{
    <form asp-controller="Admin_VisitsController" asp-action="Create" method="post" id="myForm">

        <div class="form-groupel" style="margin-bottom: 20px">
            <label asp-for="Vehicle.LicensePlate">License Plate:</label>
            <input id="licensePlateInput" asp-for="Vehicle.LicensePlate" type="text" class="form-control" placeholder="License Plate">
            <span asp-validation-for="Vehicle.LicensePlate" class="text-danger"></span>
        </div>

        <button type="submit" value="Create" class="btn btn-primary" style="display: flex; align-items: center;">
            Search
            <span class="material-symbols-outlined" style="margin-left: 5px;">
                search
            </span>
        </button>

    </form>
}
else
{
    <div style="display: flex; width: 225%;">

        <span style="flex: 1;">
            @* here is the first div *@

            <h4 style="margin-bottom: 20px; display: flex; align-items: center;">
                <span class="material-symbols-outlined" style="margin-right: 5px;">
                    directions_car
                </span>
                Vehicle
            </h4>

            <div class="form-groupel" style="margin-bottom: 15px">
                <label asp-for="Vehicle.LicensePlate">License Plate</label>
                <input id="licensePlateInput" asp-for="Vehicle.LicensePlate" type="text" class="form-control" placeholder="License Plate" disabled>
            </div>

            <div class="form-groupel" style="margin-bottom: 15px">
                <label asp-for="Vehicle.VIN">VIN</label>
                <input asp-for="Vehicle.VIN" type="text" class="form-control" placeholder="@Model.Vehicle.VIN" disabled>
            </div>

            <div class="form-groupel" style="margin-bottom: 15px">
                <label asp-for="Vehicle.Brand">Brand</label>
                <input asp-for="Vehicle.Brand" type="text" class="form-control" placeholder="@Model.Vehicle.Brand" disabled>
            </div>

            <div class="form-groupel" style="margin-bottom: 15px">
                <label asp-for="Vehicle.Brand">Model</label>
                <input asp-for="Vehicle.Model" type="text" class="form-control" placeholder="@Model.Vehicle.Model" disabled>
            </div>

            <div class="form-groupel" style="margin-bottom: 15px">
                <label asp-for="Vehicle.CreationYear">Creation Year</label>
                <input asp-for="Vehicle.CreationYear" type="text" class="form-control" placeholder="@Model.Vehicle.CreationYear" disabled>
            </div>
        </span>

        <span style="flex: 1; margin-left:30px;">
            @* here is the second div *@

            <h4 style="margin-bottom: 20px; display: flex; align-items: center;">
                <span class="material-symbols-outlined" style="margin-right: 5px;">
                    person
                </span>
                Owner
            </h4>

            <div class="form-groupel" style="margin-bottom: 15px">
                <label asp-for="Vehicle.User.Username">Username</label>
                <input asp-for="Vehicle.User.Username" type="text" class="form-control" placeholder="@Model.Vehicle.User.Username" disabled>
            </div>

            <div class="form-groupel" style="margin-bottom: 15px">
                <label asp-for="Vehicle.User.FirstName">First Name</label>
                <input asp-for="Vehicle.User.FirstName" type="text" class="form-control" placeholder="@Model.Vehicle.User.FirstName" disabled>
            </div>

            <div class="form-groupel" style="margin-bottom: 15px">
                <label asp-for="Vehicle.User.LastName">Last Name</label>
                <input asp-for="Vehicle.User.LastName" type="text" class="form-control" placeholder="@Model.Vehicle.User.LastName" disabled>
            </div>

            <div class="form-groupel" style="margin-bottom: 15px">
                <label asp-for="Vehicle.User.Email">Email</label>
                <input asp-for="Vehicle.User.Email" type="text" class="form-control" placeholder="@Model.Vehicle.User.Email" disabled>
            </div>

            <div class="form-groupel" style="margin-bottom: 15px">
                <label asp-for="Vehicle.User.PhoneNumber">Phone Number</label>
                <input asp-for="Vehicle.User.PhoneNumber" type="text" class="form-control" placeholder="@Model.Vehicle.User.PhoneNumber" disabled>
            </div>
        </span>

    </div>


    <h4 style="margin-bottom: 20px; display: flex; align-items: center; margin-top:30px;">
        <span class="material-symbols-outlined" style="margin-right: 5px;">
            package_2
        </span>
        Parts
    </h4>

    <div class="container mt-5">
        <form id="addItemForm">
            <table class="table myTable">
                <thead>
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Price (лв)</th>
                        <th scope="col"></th> <!-- Empty cell for delete button -->
                    </tr>
                </thead>
                <tbody id="itemTableBody">
                    <tr>
                        <td><input type="text" class="form-control" name="itemName"></td>
                        <td><input type="text" class="form-control" name="itemPrice"></td>
                        <td><button type="button" class="btn btn-danger delete-row">Delete</button></td>
                    </tr>
                </tbody>
            </table>
            <button type="button" class="btn btn-primary" id="addItemBtn">Add Item</button>
        </form>
    </div>



    <h4 style="margin-bottom: 20px; display: flex; align-items: center; margin-top:30px;">
        <span class="material-symbols-outlined" style="margin-right: 5px;">
            construction
        </span>
        Service
    </h4>


}


<script>
    $(document).ready(function () {
        // Listen for keypress event on the input field
        $('#licensePlateInput').keypress(function (event) {
            // Check if the pressed key is 'Enter' (key code 13)
            if (event.which === 13) {
                // Prevent the default form submission behavior
                event.preventDefault();
                // Submit the form using JavaScript
                $('#myForm').submit();
            }
        });
    });
</script>

<script>
    // Function to handle deleting rows
    function deleteRow(btn) {
        var row = btn.closest('tr');
        var tableBody = row.parentNode;
        if (tableBody.rows.length > 1) {
            row.remove();
        } else {
            alert("Cannot delete the only row!");
        }
    }

    // Adding event listener to the Add Item button
    document.getElementById('addItemBtn').addEventListener('click', function () {
        var itemName = document.createElement('input');
        itemName.setAttribute('type', 'text');
        itemName.setAttribute('class', 'form-control');
        itemName.setAttribute('name', 'itemName');

        var itemPrice = document.createElement('input');
        itemPrice.setAttribute('type', 'text');
        itemPrice.setAttribute('class', 'form-control');
        itemPrice.setAttribute('name', 'itemPrice');

        var deleteBtn = document.createElement('button');
        deleteBtn.setAttribute('type', 'button');
        deleteBtn.setAttribute('class', 'btn btn-danger delete-row');
        deleteBtn.textContent = 'Delete';
        deleteBtn.addEventListener('click', function () {
            deleteRow(this); // Call deleteRow function passing the button as parameter
        });

        var newRow = document.createElement('tr');
        var cell1 = newRow.insertCell(0);
        var cell2 = newRow.insertCell(1);
        var cell3 = newRow.insertCell(2);

        cell1.appendChild(itemName);
        cell2.appendChild(itemPrice);
        cell3.appendChild(deleteBtn);

        document.getElementById('itemTableBody').appendChild(newRow);
    });
</script>


